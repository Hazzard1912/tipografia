---
import { Image } from "astro:assets";
---

<section id="testimonios" class="py-24 bg-gradient-to-b from-neutral-50 to-neutral-100">
    <div class="container mx-auto px-4">
        <div class="max-w-3xl mx-auto text-center mb-16">
            <h2 class="font-heading text-4xl md:text-5xl font-bold text-neutral-dark mb-4">
                Lo que dicen nuestros clientes
            </h2>
            <p class="text-neutral-600 text-lg max-w-2xl mx-auto">
                Empresas y personas que han confiado en nosotros para sus necesidades de impresión
            </p>
        </div>
        
        <div id="testimonial-carousel" class="relative max-w-4xl mx-auto">
            <div class="testimonial-slider overflow-hidden">
                <div class="testimonial-track flex transition-transform duration-500">
                    <!-- Testimonio 1 -->
                    <div class="testimonial-slide min-w-full px-4">
                        <div class="bg-white rounded-2xl shadow-xl p-8 md:p-10 flex flex-col md:flex-row gap-6 items-center">
                            <div class="w-24 h-24 md:w-32 md:h-32 flex-shrink-0">
                                <img 
                                    src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?q=80&w=256&h=256&fit=crop"
                                    alt="Juan Pérez" 
                                    class="w-full h-full rounded-full object-cover border-4 border-primary shadow-md"
                                />
                            </div>
                            <div class="text-left">
                                <svg class="w-10 h-10 text-primary/20 mb-4" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h3.983v10h-9.983z" />
                                </svg>
                                <blockquote class="font-sans italic text-xl text-neutral-700 mb-6">
                                    "La calidad de los pendones superó nuestras expectativas. La atención y el profesionalismo fueron de primera. ¡Definitivamente volveremos!"
                                </blockquote>
                                <div class="flex items-center">
                                    <div>
                                        <div class="font-sans font-bold text-neutral-900">Juan Pérez</div>
                                        <div class="font-sans text-neutral-600">Gerente, Publicidad Creativa</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Testimonio 2 -->
                    <div class="testimonial-slide min-w-full px-4">
                        <div class="bg-white rounded-2xl shadow-xl p-8 md:p-10 flex flex-col md:flex-row gap-6 items-center">
                            <div class="w-24 h-24 md:w-32 md:h-32 flex-shrink-0">
                                <img 
                                    src="https://images.unsplash.com/photo-1534528741775-53994a69daeb?q=80&w=256&h=256&fit=crop"
                                    alt="María Gómez" 
                                    class="w-full h-full rounded-full object-cover border-4 border-secondary shadow-md"
                                />
                            </div>
                            <div class="text-left">
                                <svg class="w-10 h-10 text-secondary/20 mb-4" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h3.983v10h-9.983z" />
                                </svg>
                                <blockquote class="font-sans italic text-xl text-neutral-700 mb-6">
                                    "Excelente servicio y resultados. Nos ayudaron a destacar nuestra marca con materiales de alta calidad."
                                </blockquote>
                                <div class="flex items-center">
                                    <div>
                                        <div class="font-sans font-bold text-neutral-900">María Gómez</div>
                                        <div class="font-sans text-neutral-600">Directora, Eventos Cali</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Testimonio 3 -->
                    <div class="testimonial-slide min-w-full px-4">
                        <div class="bg-white rounded-2xl shadow-xl p-8 md:p-10 flex flex-col md:flex-row gap-6 items-center">
                            <div class="w-24 h-24 md:w-32 md:h-32 flex-shrink-0">
                                <img 
                                    src="https://images.unsplash.com/photo-1500648767791-00dcc994a43e?q=80&w=256&h=256&fit=crop"
                                    alt="Carlos Ruiz" 
                                    class="w-full h-full rounded-full object-cover border-4 border-accent shadow-md"
                                />
                            </div>
                            <div class="text-left">
                                <svg class="w-10 h-10 text-accent/20 mb-4" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h3.983v10h-9.983z" />
                                </svg>
                                <blockquote class="font-sans italic text-xl text-neutral-700 mb-6">
                                    "Rápidos, atentos y con acabados impecables. ¡Recomendados para cualquier proyecto de impresión!"
                                </blockquote>
                                <div class="flex items-center">
                                    <div>
                                        <div class="font-sans font-bold text-neutral-900">Carlos Ruiz</div>
                                        <div class="font-sans text-neutral-600">CEO, Soluciones Empresariales</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Navegación del carrusel -->
            <div class="flex items-center justify-between mt-10">
                <button id="prev-btn" class="bg-white p-3 rounded-full shadow-md hover:bg-neutral-50 transition-colors" aria-label="Anterior testimonio">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-neutral-700">
                        <path d="M15 18l-6-6 6-6"></path>
                    </svg>
                </button>
                
                <div class="flex gap-3">
                    <button class="testimonial-dot w-3 h-3 rounded-full bg-primary opacity-100" aria-label="Testimonio 1"></button>
                    <button class="testimonial-dot w-3 h-3 rounded-full bg-primary opacity-40" aria-label="Testimonio 2"></button>
                    <button class="testimonial-dot w-3 h-3 rounded-full bg-primary opacity-40" aria-label="Testimonio 3"></button>
                </div>
                
                <button id="next-btn" class="bg-white p-3 rounded-full shadow-md hover:bg-neutral-50 transition-colors" aria-label="Siguiente testimonio">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-neutral-700">
                        <path d="M9 18l6-6-6-6"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>
</section>

<script>
    if (typeof window !== "undefined") {
        import("gsap").then(({ default: gsap }) => {
            // Variables
            const track = document.querySelector(".testimonial-track");
            const slides = Array.from(document.querySelectorAll(".testimonial-slide"));
            const dots = Array.from(document.querySelectorAll(".testimonial-dot"));
            const prevBtn = document.getElementById("prev-btn");
            const nextBtn = document.getElementById("next-btn");
            let current = 0;
            const slideCount = slides.length;
            
            // Inicializar posiciones
            function updateCarousel() {
                if (track) {
                    gsap.to(track, {
                        duration: 0.6,
                        x: -current * 100 + "%",
                        ease: "power3.out"
                    });
                    
                    // Actualizar dots
                    dots.forEach((dot, i) => {
                        dot.classList.toggle("opacity-100", i === current);
                        dot.classList.toggle("opacity-40", i !== current);
                    });
                }
            }
            
            // Event listeners
            if (prevBtn) {
                prevBtn.addEventListener("click", () => {
                    current = (current - 1 + slideCount) % slideCount;
                    updateCarousel();
                });
            }
            
            if (nextBtn) {
                nextBtn.addEventListener("click", () => {
                    current = (current + 1) % slideCount;
                    updateCarousel();
                });
            }
            
            dots.forEach((dot, i) => {
                dot.addEventListener("click", () => {
                    current = i;
                    updateCarousel();
                });
            });
            
            // Auto rotate
            const autoplayInterval = 6000; // 6 segundos
            let autoplayTimer = setInterval(() => {
                current = (current + 1) % slideCount;
                updateCarousel();
            }, autoplayInterval);
            
            // Pausa el autoplay al interactuar
            const carousel = document.getElementById("testimonial-carousel");
            if (carousel) {
                carousel.addEventListener("mouseenter", () => {
                    clearInterval(autoplayTimer);
                });
                
                carousel.addEventListener("mouseleave", () => {
                    autoplayTimer = setInterval(() => {
                        current = (current + 1) % slideCount;
                        updateCarousel();
                    }, autoplayInterval);
                });
            }
            
            // Animación inicial
            gsap.from("#testimonios", {
                scrollTrigger: {
                    trigger: "#testimonios",
                    start: "top 80%",
                },
                y: 60,
                opacity: 0,
                duration: 0.8,
                ease: "power3.out",
            });
        });
    }
</script>
